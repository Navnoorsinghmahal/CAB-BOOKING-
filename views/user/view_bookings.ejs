
<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <%-include('../pages/headerFiles')%>

</head>
<body onload="viewUsers()">
<%-include('../pages/header_user')%>

<div class="slider-section">
    <div class="main-slider-2">
        <div class="swiper-wrapper">
            <div class="swiper-slide">
                <div class="slider-img"><img src="assets/img/slider-bg.jpg" alt="img" class="kenburns" style="animation-duration: 12000ms; "></div>
                <div class="slider-content-wrap d-flex align-items-center text-left">
                    <div class="container">
                        <div class="slider-content text-center pb-60">
                            <div class="slider-caption medium">
                                <div class="inner-layer">
                                    <div data-animation="fade-in-bottom" data-delay="0.3s">Travel securely with us!</div>
                                </div>
                            </div>
                            <div class="slider-caption big">
                                <div class="inner-layer">
                                    <div data-animation="fade-in-bottom" data-delay="0.5s">Book your taxi from <br>anywhare today!</div>
                                </div>
                            </div>
                            <div class="slider-caption small">
                                <div class="inner-layer">
                                    <div data-animation="fade-in-bottom" data-delay="0.7s" data-duration="1s">Everything your taxi business needs is already here! <br>Ridek made for taxi service companies!</div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <div class="swiper-slide">
                <div class="slider-img"><img src="assets/img/slider-bg.jpg" alt="img" class="kenburns" style="animation-duration: 12000ms; "></div>
                <div class="slider-content-wrap d-flex align-items-center text-left">
                    <div class="container">
                        <div class="slider-content text-center pb-60">
                            <div class="slider-caption medium">
                                <div class="inner-layer">
                                    <div data-animation="fade-in-bottom" data-delay="0.3s">Travel securely with us!</div>
                                </div>
                            </div>
                            <div class="slider-caption big">
                                <div class="inner-layer">
                                    <div data-animation="fade-in-bottom" data-delay="0.5s">Book your taxi from <br>anywhare today!</div>
                                </div>
                            </div>
                            <div class="slider-caption small">
                                <div class="inner-layer">
                                    <div data-animation="fade-in-bottom" data-delay="0.7s" data-duration="1s">Everything your taxi business needs is already here! <br>Ridek made for taxi service companies!</div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>

<div class="container mt-5">
    <h1 class="mb-4">Your Bookings</h1>
    <div id="bookingsContainer"></div>

</div>
<div class="modal fade" id="infoModal" tabindex="-1" aria-labelledby="infoModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="infoModalLabel">Driver Information</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" id="modalContent"></div>
            <div class="modal-footer">

                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<%-include('../pages/footer')%>

<%-include('../pages/scripts')%>

<script>

    let viewUsers = () => {
        fetch("/viewBookings",{
            method: "POST"}).
        then(res => res.json())
            .then(res => {
                // console.log(res);
                if (res.error === false) {
                    let ans = `<table class='table'>
<thead>
<tr class="text-center">
<th>Sr. No.</th>
<th>Car</th>
<th>Start Date</th>
<th>End Date</th>
<th>Number of days</th>
<th>Amount Paid </th>
<th colspan="2">Car Details</th>
</tr>
</thead>`;
                    let records = res.records;

                    data = res.records;

                    if (records.length > 0) {
                        let i = 0;
                        records.forEach((data) => {
                            console.log("data from table---------------")
                            console.log(data)
                            let row = JSON.stringify(data)
                            console.log(row)
                            ans += `<tr class="text-center">
<td>${++i}</td>
<td>${data.carName}</td>
<td>${data.Dates_from} </td>
<td>${data.Dates_to}</td>
<td>${data.Days_booked}</td>
<td>${data.Amount}</td>
<td><button type="button" class="btn btn-warning" onclick="all_information(${data.Car_id})" data-bs-toggle="modal" data-bs-target="#editModal"><i class="fa fa-info"></i> </button> </td>

<td></td>
</tr>`
                        })
                    } else {
                        ans += `<tr class="text-center">
<td colspan="8"><div class="alert alert-danger">No data found</div><td>
</tr>`
                    }


                    ans += `</table>`
                    document.getElementById("bookingsContainer").innerHTML = ans

                }
            })
            .catch((e)=>{
                console.log(e)
            })

    }

    function all_information(driverId) {
        fetch(`/all_information/${driverId}`)
            .then(res => res.json())
            .then(res => {
                if (res.error === false) {
                    let data = res.records[0];
                    let content = '';
                    if (data) {
                        content = `
                        <div class="card mb-3">
                            <div class="row no-gutters">
                                <div class="col-md-4">
                                    <img src="/${data.photo}" class="card-img" alt="${data.name}">
                                </div>
                                <div class="col-md-8">
                                    <div class="card-body">
                                        <h5 class="card-title">${data.name}</h5>

                                        <p class="card-text"><strong>Brand:</strong> ${data.brand}</p>
                                        <p class="card-text"><strong>Type:</strong> ${data.type}</p>
                                        <p class="card-text"><strong>Description:</strong> ${data.description}</p>
                                        <p class="card-text"><strong>Fuel Type:</strong> ${data.fuelType}</p>

                                        <p class="card-text"><strong>Colour:</strong> ${data.colour}</p>
                                        <p class="card-text"><strong>Model Year:</strong> ${data.modelYear}</p>
                                        <p class="card-text"><strong>AC:</strong> ${data.ac}</p>
                                        <p class="card-text"><strong>Seater:</strong> ${data.seater}</p>
                                        <p class="card-text"><strong>Transmission:</strong> ${data.transmission}</p>
                                    </div>
                                </div>
                            </div>
                        </div>`;
                    } else if(res.error === true) {
                        content = `<div class="alert alert-danger">No data found</div>`;
                    }
                    document.getElementById("modalContent").innerHTML = content;

                    var infoModal = new bootstrap.Modal(document.getElementById('infoModal'));
                    infoModal.show();
                }
            })
            .catch(e => console.log(e));
    }


</script>
</body>
</html>

